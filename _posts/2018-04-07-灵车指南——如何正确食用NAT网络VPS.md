---
layout:     post
title:      "灵车指南——如何正确食用NAT网络VPS"
subtitle:   
date:       2018-04-07
author:     "漆黑菌"
header-img: "img/post-bg.jpg"
catalog: true
tags:
    - hosthongkong
    - 香港
    - NAT
    - VPS
---

## 为什么要用NAT？什么是NAT?
前段时间问了问做IDC的商家才知道原来VPS服务里面IP地址也是很贵的，相对应的也就有了新招数——搞NAT，让几台VPS共享一个IP地址。其实这个服务我们几乎天天在用，典型的就是一台路由器拖一家全部设备这个场景，其实对外只有一个IP地址，有了NAT局域网设备才能正确访问局域网之外的服务。无线路由器会根据一张NAT表发送和接受数据，让不同的设备发送的数据正确的回到发送它的设备上，详情可以搜索关键字NAT。

## 为什么选择上（ling）车
前段时间复活节优惠hosthongkong放货NAT VPS，抱着试一试的态度就买了个来玩玩。年付65HKD，折合人民币大概53元钱，支持PayPal付款，对了付款的时候记得看付款货币，这家不支持CNY付款，我就因为这个被卡主了无法付款，向客服发个工单就改成港币了。哦对了，看说明这个机器卵服务都没有，仅限于自己胡闹玩玩，爆炸也不奇怪。毕竟应该是目前最便宜的HK NAT机器了，一文价钱一文货。

## 如何SSH登陆VPS
支付成功后很快就会开机，并向邮箱发送一封邮件，里面包括机器的一个主IP（内网IPV4地址）、root密码、一个IPv6地址。查看NAT原理后不难发现，NAT机器的ip是共享的，所以理论上应该通过一个IPv4地址+端口号的模式去访问机器。我一开始也被这个唬住了，以为那个IPv4地址是公网IP。这是一个误区，继续往下看还有一个**SSH Access Information**这个才是关键。

![邮件中的登陆信息](https://cl.ly/1E351c3X2K3Q/download/Image%202018-04-07%20at%209.37.25%20PM.png)

这里就会告诉我们，那个主IP仅仅是个私有IP，也就是内网IP，并不能用于外网访问。公共地址是一个域名。这里就要简单解释一下，这个NAT VPS实际上是动态IP NAT。为了方便管理，运营商把这个机器绑定到了一个域名上，这样就算IP改变了照样可以通过这个域名来访问。下面还有一部分内容是举例子告诉你如何查看自己的SSH端口，说白了就是私有IP最后一段加上两个0。我的IP最后一段是240，所以端口是2400，其他的就和正常VPS一样了。域名代替IP地址，端口号用推算的代替22，用root+密码登陆即可。

## 关于端口号
目前来看不同商家的政策不同有些厂家是公网端口号按照一个表映射到本地端口号，还有一种是能被公网访问的端口号只能是指定的几个，这个就需要具体问题具体分析了。我这家送了IPv6地址。虽然大陆非教育网并不能使用IPv6，但是在cloudflare里面绑定一个AAAA地址域名，再套个CDN加速就能间接通过IPv6访问端口啦。